import{a as d,_ as w,e as S,f as _,R as v,j as i}from"./index-Ty-b1T-x.js";function N(n){return n.split("-").filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("")}const y=(n,e,t)=>{const o=new RegExp(`./${e}/(.*)/${t}.tsx`).exec(n);if(o&&o.length>1){const s=o[1];return N(s)}throw new Error("Cannot identify component name")},O=d.createContext(null),x={didCatch:!1,error:null};class b extends d.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=x}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,r,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];(t=(r=this.props).onReset)===null||t===void 0||t.call(r,{args:s,reason:"imperative-api"}),this.setState(x)}}componentDidCatch(e,t){var r,o;(r=(o=this.props).onError)===null||r===void 0||r.call(o,e,t)}componentDidUpdate(e,t){const{didCatch:r}=this.state,{resetKeys:o}=this.props;if(r&&t.error!==null&&P(e.resetKeys,o)){var s,a;(s=(a=this.props).onReset)===null||s===void 0||s.call(a,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(x)}}render(){const{children:e,fallbackRender:t,FallbackComponent:r,fallback:o}=this.props,{didCatch:s,error:a}=this.state;let c=e;if(s){const m={error:a,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")c=t(m);else if(r)c=d.createElement(r,m);else if(o!==void 0)c=o;else throw a}return d.createElement(O.Provider,{value:{didCatch:s,error:a,resetErrorBoundary:this.resetErrorBoundary}},c)}}function P(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,r)=>!Object.is(t,e[r]))}const k=Object.assign({"./components/box/index.tsx":S,"./components/button/index.tsx":w}),M=Object.assign({"./templates/empty/index.tsx":_}),E={},j={};for(const[n,e]of Object.entries(k)){const{default:t}=e;t.displayName=y(n,"components","index"),E[t.displayName]=t}for(const[n,e]of Object.entries(M)){const{default:t}=e;t.displayName=y(n,"templates","index"),j[t.displayName]=t}const C={Components:E,Templates:j};console.log(C);const g=Symbol();function T(n){const e=v.createContext(g);function t(o){const s=n(o.initialState);return i.jsx(e.Provider,{value:s,children:o.children})}function r(){const o=v.useContext(e);if(o===g)throw new Error("Component must be wrapped with <Container.Provider>");return o}return{Provider:t,useContainer:r}}const B=T(n=>n),R=({id:n,type:e})=>{const t=B.useContainer(),{Component:r,options:o,events:s,children:a,name:c,style:m}=d.useMemo(()=>{const{options:u,events:p,children:h,style:l}=e==="component"?t.components[n]:t,f=e==="component"?t.components[n].name:t.template;return{Component:e==="component"?C.Components[f]:C.Templates[f],options:u,events:p,children:h,name:f,style:l}},[t,n,e]);return i.jsx(b,{fallback:`${c}@${n} 渲染出错`,children:i.jsx(r,{id:n,"data-component-id":n,style:m,options:o,events:s,children:(function(){if(!a)return;const u={};for(const[p,h]of Object.entries(a))u[p]=h.filter(l=>!!t.components[l]).map(l=>i.jsx(R,{id:l,type:"component"},l));return u})()})})},K=({schema:n})=>i.jsx(b,{fallback:i.jsx("div",{children:"出错了"}),children:i.jsx(B.Provider,{initialState:n,children:i.jsx(R,{id:n.template,type:"template"})})});export{K as R,y as g};
